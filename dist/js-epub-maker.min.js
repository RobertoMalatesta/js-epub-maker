!function e(t,n,i){function o(u,s){if(!n[u]){if(!t[u]){var l="function"==typeof require&&require;if(!s&&l)return l(u,!0);if(r)return r(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var a=n[u]={exports:{}};t[u][0].call(a.exports,function(e){var n=t[u][1][e];return o(n?n:e)},a,a.exports,e,t,n,i)}return n[u].exports}for(var r="function"==typeof require&&require,u=0;u<i.length;u++)o(i[u]);return o}({1:[function(e,t,n){!function(){"use strict";var i="undefined"!=typeof console&&console.debug?function(){console.debug.apply(console,arguments)}:function(){},o=e("./js/slugify.js"),r={"idpf-wasteland":e("../src/js/template-builders/idpf-wasteland-builder.js").builder},u=function(){var e=this,t={toc:[],landmarks:[],sections:[]};this.withUuid=function(n){return t.uuid=n,e},this.withTemplate=function(n){return t.templateName=n,e},this.withTitle=function(n){return t.title=n,t.slug=o(n),e},this.withLanguage=function(n){return t.lang=n,e},this.withAuthor=function(n){return t.author=n,e},this.withModificationDate=function(n){return t.modificationDate=n.toISOString(),e},this.withRights=function(n){return t.rights=n,e},this.withCover=function(n,i){return t.coverUrl=n,t.coverRights=i,e},this.withAttributionUrl=function(n){return t.attributionUrl=n,e},this.withSection=function(n){return t.sections.push(n),Array.prototype.push.apply(t.toc,n.collectToc()),Array.prototype.push.apply(t.landmarks,n.collectLandmarks()),e},this.makeEpub=function(){return t.publicationDate=(new Date).toISOString(),r[t.templateName].make(t).then(function(e){i("generating epub for: "+t.title);var n=e.generate({type:"blob",mimeType:"application/epub+zip",compression:"DEFLATE"});return n})},this.downloadEpub=function(){e.makeEpub().then(function(e){var n=t.slug+".epub";i('saving "'+n+'"...'),saveAs(e,n)})}};if(u.Section=function(e,t,n,i,o){var r=this;this.epubType=e,this.id=t,this.content=n,this.includeInToc=i,this.includeInLandmarks=o,this.subSections=[],this.withSubSection=function(e){return r.subSections.push(e),r},this.collectToc=function(){for(var e=r.includeInToc?[r]:[],t=0;t<r.subSections.length;t++)Array.prototype.push.apply(e,r.subSections[t].collectToc());return e},this.collectLandmarks=function(){for(var e=r.includeInLandmarks?[r]:[],t=0;t<r.subSections.length;t++)Array.prototype.push.apply(e,r.subSections[t].collectLandmarks());return e}},"undefined"!=typeof t)t.exports.EpubMaker=u;else if("undefined"!=typeof n)n.EpubMaker=u;else if("undefined"==typeof window)throw new Error("unable to expose EpubMaker: no module, exports object and no global window detected");"undefined"!=typeof window&&(window.EpubMaker=u)}()},{"../src/js/template-builders/idpf-wasteland-builder.js":3,"./js/slugify.js":2}],2:[function(e,t,n){!function(){function e(e){return e.toLowerCase().replace(/\s/g,"-")}if(t.exports="undefined"!=typeof s&&s.slugify?s.slugify:e,t.exports===e){var n="undefined"!=typeof console&&console.debug?console.debug:function(){};n.call(console,"underscore.string not found, falling back on (very) simple slugify..")}}()},{}],3:[function(e,t,n){!function(){"use strict";var e="dist/epub_templates/from_idpf_epub3/wasteland",i=function(){function t(t,n){return $.get(e+"/mimetype",function(e){t.file("mimetype",e)},"text")}function n(t,n){return $.get(e+"/META-INF/container.xml",function(e){t.folder("META-INF").file("container.xml",Handlebars.compile(e)(n))},"text")}function i(t,n){return $.get(e+"/EPUB/wasteland.opf",function(e){t.folder("EPUB").file(n.slug+".opf",Handlebars.compile(e)(n))},"text")}function o(e,t){var n=$.Deferred();return t.coverUrl?JSZipUtils.getBinaryContent(t.coverUrl,function(i,o){i?n.reject(i):(e.folder("EPUB").file(t.slug+"-cover.jpg",o,{binary:!0}),n.resolve(""))}):n.resolve(""),n.promise()}function r(t,n){return $.get(e+"/EPUB/wasteland.ncx",function(e){t.folder("EPUB").file(n.slug+".ncx",Handlebars.compile(e)(n))},"text")}function u(t,n){return $.get(e+"/EPUB/wasteland-nav.xhtml",function(e){t.folder("EPUB").file(n.slug+"-nav.xhtml",Handlebars.compile(e)(n))},"text")}function s(t,n){return $.when($.get(e+"/EPUB/wasteland.css",function(e){t.folder("EPUB").file(n.slug+".css",Handlebars.compile(e)(n))},"text"),$.get(e+"/EPUB/wasteland-night.css",function(e){t.folder("EPUB").file(n.slug+"-night.css",Handlebars.compile(e)(n))},"text"))}function l(t,n){var i=function(e){return e};return $.when($.get(e+"/EPUB/sections-template.xhtml",i,"text").then(i),$.get(e+"/EPUB/wasteland-content.xhtml",i,"text").then(i)).then(function(e,i){Handlebars.registerPartial("sectionTemplate",e),t.folder("EPUB").file(n.slug+"-content.xhtml",Handlebars.compile(i)(n))})}this.make=function(e){console.debug("building epub",e);var c=new JSZip,a=$.Deferred();return $.when(t(c,e),n(c,e),i(c,e),o(c,e),r(c,e),u(c,e),s(c,e),l(c,e)).then(function(){a.resolve(c)}),a.promise()}};if("undefined"!=typeof t)t.exports.builder=new i;else if("undefined"!=typeof n)n.builder=new i;else if("undefined"==typeof window)throw new Error("unable to expose module: no module, exports object and no global window detected");"undefined"!=typeof window&&(window.epubMaker=new i)}()},{}]},{},[1]);